{"version":3,"file":"Editor.js","sources":["Editor.js"],"names":["define","declare","_WidgetBase","_TemplatedMixin","_WidgetsInTemplateMixin","lang","domConstruct","topic","aspect","template","i18n","templateString","widgetsInTemplate","editor","isEdit","mapClickMode","postCreate","this","inherited","arguments","own","subscribe","hitch","parentWidget","toggleable","after","onLayoutChange","open","toggleEditing","endEditing","publish","ops","clone","settings","map","layerInfos","con","create","innerHTML","style","containerNode","require","Editor","startup","toggleBTN","set","labels","stopEditing","destroyRecursive","startEditing","setMapClickMode","mode"],"mappings":";;;;;AAAAA,QACI,qBACA,oBACA,wBACA,gCACA,kBACA,qBACA,aACA,cACA,2CACA,kCAEA,qBACD,SAAUC,EAASC,EAAaC,EAAiBC,EAAyBC,EAAMC,EAAcC,EAAOC,EAAQC,EAAUC,GAEtH,MAAOT,IAASC,EAAaC,EAAiBC,IAC1CO,eAAgBF,EAChBC,KAAMA,EACNE,mBAAmB,EACnBC,OAAQ,KACRC,QAAQ,EACRC,aAAc,KACdC,WAAY,WACRC,KAAKC,UAAUC,WACfF,KAAKG,IAAIb,EAAMc,UAAU,0BAA2BhB,EAAKiB,MAAML,KAAM,qBACjEA,KAAKM,cAAgBN,KAAKM,aAAaC,YACvCP,KAAKG,IAAIZ,EAAOiB,MAAMR,KAAKM,aAAc,SAAUlB,EAAKiB,MAAML,KAAM,WAChEA,KAAKS,eAAeT,KAAKM,aAAaI,WAIlDC,cAAe,WACX,GAAKX,KAAKH,OAsBNG,KAAKY,aACLtB,EAAMuB,QAAQ,+BAvBA,CACd,GAAIC,GAAM1B,EAAK2B,MAAMf,KAAKgB,SAC1BF,GAAIG,IAAMjB,KAAKiB,IACfH,EAAII,WAAalB,KAAKkB,UAEtB,IAAIC,GAAM9B,EAAa+B,OAAO,OAC1BC,UAAW,84EACXC,MAAS,sBACVtB,KAAKuB,cAAe,OAEvBC,UAAS,6BAA8BpC,EAAKiB,MAAML,KAAM,SAAUyB,GAC9DzB,KAAKJ,OAAS,GAAI6B,IACdT,SAAUF,GACXK,GACHnB,KAAKJ,OAAO8B,aAGhB1B,KAAK2B,UAAUC,IAAI,QAAS5B,KAAKP,KAAKoC,OAAOC,aAC7C9B,KAAK2B,UAAUC,IAAI,QAAS,UAC5B5B,KAAKH,QAAS,EACdP,EAAMuB,QAAQ,0BAA2B,YAMjDD,WAAY,WACJZ,KAAKJ,QAAUI,KAAKJ,OAAOmC,kBAC3B/B,KAAKJ,OAAOmC,mBAEhB/B,KAAK2B,UAAUC,IAAI,QAAS5B,KAAKP,KAAKoC,OAAOG,cAC7ChC,KAAK2B,UAAUC,IAAI,QAAS,WAC5B5B,KAAKH,QAAS,EACdG,KAAKJ,OAAS,MAGlBa,eAAgB,SAAUC,GAEjBA,GAA8B,WAAtBV,KAAKF,eACdE,KAAKY,aACLtB,EAAMuB,QAAQ,6BAGtBoB,gBAAiB,SAAUC,GACvBlC,KAAKF,aAAeoC,EACP,WAATA,GACAlC,KAAKY","sourcesContent":["define([\n    'dojo/_base/declare',\n    'dijit/_WidgetBase',\n    'dijit/_TemplatedMixin',\n    'dijit/_WidgetsInTemplateMixin',\n    'dojo/_base/lang',\n    'dojo/dom-construct',\n    'dojo/topic',\n    'dojo/aspect',\n    'dojo/text!./Editor/templates/Editor.html',\n    'dojo/i18n!./Editor/nls/resource',\n\n    'dijit/form/Button'\n], function (declare, _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin, lang, domConstruct, topic, aspect, template, i18n) {\n\n    return declare([_WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin], {\n        templateString: template,\n        i18n: i18n,\n        widgetsInTemplate: true,\n        editor: null,\n        isEdit: false,\n        mapClickMode: null,\n        postCreate: function () {\n            this.inherited(arguments);\n            this.own(topic.subscribe('mapClickMode/currentSet', lang.hitch(this, 'setMapClickMode')));\n            if (this.parentWidget && this.parentWidget.toggleable) {\n                this.own(aspect.after(this.parentWidget, 'toggle', lang.hitch(this, function () {\n                    this.onLayoutChange(this.parentWidget.open);\n                })));\n            }\n        },\n        toggleEditing: function () {\n            if (!this.isEdit) {\n                var ops = lang.clone(this.settings);\n                ops.map = this.map;\n                ops.layerInfos = this.layerInfos;\n\n                var con = domConstruct.create('div', {\n                    innerHTML: '<img style=\"display:inline;\" src=\"data:image/gif;base64,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\"/>',\n                    'style': 'text-align:center;'\n                }, this.containerNode, 'only');\n\n                require(['esri/dijit/editing/Editor'], lang.hitch(this, function (Editor) {\n                    this.editor = new Editor({\n                        settings: ops\n                    }, con);\n                    this.editor.startup();\n                }));\n\n                this.toggleBTN.set('label', this.i18n.labels.stopEditing);\n                this.toggleBTN.set('class', 'danger');\n                this.isEdit = true;\n                topic.publish('mapClickMode/setCurrent', 'editor');\n            } else {\n                this.endEditing();\n                topic.publish('mapClickMode/setDefault');\n            }\n        },\n        endEditing: function () {\n            if (this.editor && this.editor.destroyRecursive) {\n                this.editor.destroyRecursive();\n            }\n            this.toggleBTN.set('label', this.i18n.labels.startEditing);\n            this.toggleBTN.set('class', 'success');\n            this.isEdit = false;\n            this.editor = null;\n        },\n\n        onLayoutChange: function (open) {\n            // end edit on close of title pane\n            if (!open && this.mapClickMode === 'editor') {\n                this.endEditing();\n                topic.publish('mapClickMode/setDefault');\n            }\n        },\n        setMapClickMode: function (mode) {\n            this.mapClickMode = mode;\n            if (mode !== 'editor') {\n                this.endEditing();\n            }\n        }\n    });\n});"]}